# Стажировка Моторика, спринт 2

24 мая 2023, Г.Бут,О.Мархай, Команда 3

Другой (второй) спринт стажировки в компании Моторика. Задача спринта - распознать (предсказать) положение каждого пальца на руке по результатам измерения ОМГ датчиков. Новый формат входных данных. Несколько пилотов. Пилот в ходе опыта совершает пронации - вращения запястьем и кистью вокруг локтевой оси. В решении я вернулся к предложенным в компани рекурсивным НС моделям. Одно из важных ограничений решения - обработка входных данных в реальном времени. Время обработки не должно превышать 33 мСек.

Первоначально я предполагал распознавать пронацию по результатам ОМГ измерений. Однако в дальнейшем я остановился на гипотезе игнорирования пронации. Довольно простая модель обеспечивала хорошее качество распознавания. 

Файл **Sprint2_ENCModel_02.ipynb** реализует следующий алгоритм:
- чтение входного файла в формате palm
- отбор значимых сенсоров с высоким уровнем сигнала,    
- MinMax масштабирование значений сенсоров,     
- выделение диапазона тестовых измерений для контроля переобучения НС модели,     
- нарезка фрагментов входных данных для обучения НС модели,      
- формирование рекуррентной НС модели, ее обучение и контроль ее качества,   
- построение statefull рекуррентной НС модели для последовательного инференса на основе трансфера весов обычной модели и контроль ее качества, 
- формирование обработок для последовательного инференса на основе statefull реккурентной НС модели, 
- прокси-моделирование обработок последовательного инференса на фрагменте входных данных и замер производительности. 
Достигнутая производительность - 7.22 мСек на наблюдение, условиям ограничения соответствует. Качество распознавания зависит от пилота. На данных второго пилота оно лучше. 

Файл **Sprint2_ENCModel_03_Ol.ipynb** реализует тот же алгоритм за исключением архитектуры модели - слои LSTM и GRU вместо Simple RNN. 
Производительность 11.8 мСек, при лучшем качестве предсказания по MSE.  Модель разработана [Ольгой М.](https://github.com/OlgaMarkhai).  


Ключевые результаты разработки и отладки НС решения:
- В разработке НС моделей ключевое значение имеют регуляризация и борьба с переобучением.
- Данные для обучения НС модели должны быть подготовлены с учетом планируемой архитектуры рекуррентной НС модели.
- Statefull рекуррентная модель при последовательном выводе может сохранять в своей памяти результаты предыдущего вывода и не требует внешней дополнительной обвязки памятью. Рекуррентную НС модель можно обучить как обычную, а затем полученные веса использовать в statefull модели с внутренней памятью. Требуется контроль правильности трансфера весов.   
